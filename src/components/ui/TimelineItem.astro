---
import { cn } from "@/lib/utils";
import { TechLabel } from "./TechLabel";

interface Props {
  title: string;
  company: string;
  location: string;
  date: string;
  description?: string;
  techStack?: string[];
  color?: "purple" | "blue";
  class?: string;
}

const {
  title,
  company,
  location,
  date,
  description,
  techStack,
  color = "purple",
  class: className,
} = Astro.props;

const colorStyles = {
  purple: {
    dotBg: "bg-purple-500",
    dotText: "text-purple-500",
    dateText: "text-purple-400",
  },
  blue: {
    dotBg: "bg-blue-500",
    dotText: "text-blue-500",
    dateText: "text-blue-400",
  },
};

const styles = colorStyles[color];
---

<div class={cn("relative pl-12 group", className)}>
  {/* Dot on Line */}
  <span
    class={cn(
      "absolute -translate-x-full -left-6 top-2.5 text-sm font-mono font-bold whitespace-nowrap capitalize",
      styles.dateText,
    )}
  >
    {date}
  </span>
  <div
    class={cn(
      "absolute -left-[9px] top-2 w-5 h-5 rounded-full border-4 border-gray-900 group-hover:scale-125 transition-transform duration-300 shadow-[0_0_10px_currentColor]",
      styles.dotBg,
      styles.dotText,
    )}
  >
  </div>

  <div
    class="flex flex-col justify-between sm:flex-row sm:items-baseline gap-2 mb-1"
  >
    <h3 class="text-xl font-bold text-white">{title}</h3>
  </div>
  <div class="text-lg text-gray-300 font-medium mb-2">
    {company}
    <span class="text-gray-500 text-sm">â€¢ {location}</span>
  </div>
  {
    description && (
      <p class="text-gray-400 text-sm max-w-2xl leading-relaxed">
        {description}
      </p>
    )
  }

  {/* Tech Stack Badge */}
  {
    techStack && techStack.length > 0 && (
      <div class="mt-3 flex flex-wrap gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
        {techStack.map((tech) => (
          <TechLabel name={tech} className="px-2 py-0.5 text-xs" />
        ))}
      </div>
    )
  }
</div>
