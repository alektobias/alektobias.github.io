---
import fs from "node:fs/promises";
import path from "node:path";
import Contact from "../home/Contact.astro";
import contact from "../../../docs/data/contact.json";
import skills from "../../../docs/data/techskills.json"; // Direct import like HeroSection
import { loadUiData } from "../../utils/loadData";
import { AuroraText } from "../ui/aurora-text";

interface Props {
  lang?: string;
}

const { lang = "en" } = Astro.props;
const ui = await loadUiData(lang);

// Load Profile Data
const profilePath = path.join(process.cwd(), `docs/data/${lang}/profile.json`);
const profile = JSON.parse(await fs.readFile(profilePath, "utf-8"));

// Load Experiences Data (Required for Contact -> CVDownloader)
const experiencesPath = path.join(
  process.cwd(),
  `docs/data/${lang}/experiences.json`,
);
const experiences = JSON.parse(await fs.readFile(experiencesPath, "utf-8"));

const currentYear = new Date().getFullYear();
const mainTitle = profile.title[0];

const navLinks = [
  { name: ui?.nav?.home, href: "#" },
  { name: ui?.nav?.about, href: "#about" },
  { name: ui?.nav?.skills, href: "#skills" },
  { name: ui?.nav?.experience, href: "#experiences" },
  { name: ui?.nav?.contact, href: "#contact" },
];
---

<footer
  class="bg-black border-t border-white/10 py-12 relative overflow-hidden"
>
  {/* Background glow similar to other sections but subtle */}
  <div
    class="absolute top-0 left-1/2 -translate-x-1/2 w-[600px] h-[200px] bg-emerald-900/10 blur-[80px] rounded-full pointer-events-none"
  >
  </div>

  <div class="container relative z-10">
    <div
      class="flex flex-col md:flex-row justify-between items-start md:items-center gap-8"
    >
      {/* Brand Section */}
      <div class="space-y-2">
        <h2 class="text-3xl font-bold tracking-tight">
          <AuroraText
            className="text-3xl font-bold tracking-tight inline-block"
            colors={["#34d399", "#10b981", "#064e3b"]}
            client:only="react"
          >
            {profile.name}
          </AuroraText>
        </h2>
        <p
          class="text-gray-400 font-medium text-sm tracking-wide"
          style={{
            backgroundImage: "linear-gradient(to bottom right, #ccc 70%, #333)", // emerald-300 to emerald-900
            backgroundClip: "text",
            WebkitBackgroundClip: "text",
            color: "transparent",
          }}
        >
          {mainTitle}
        </p>
      </div>

      {/* Navigation & Social */}
      <div class="flex flex-col md:items-end gap-6 w-full md:w-auto">
        <nav class="flex flex-wrap gap-6 text-sm font-medium">
          {
            navLinks.map((link) => (
              <a
                href={link.href}
                class="text-gray-400 hover:text-emerald-400 transition-colors"
              >
                {link.name}
              </a>
            ))
          }
        </nav>

        <div class="flex gap-4">
          <Contact
            contact={contact}
            profile={profile}
            experiences={experiences}
            skills={skills}
            ui={ui}
          />
        </div>
      </div>
    </div>

    <div
      class="mt-12 pt-8 border-t border-white/5 flex flex-col md:flex-row justify-between items-center text-gray-600 text-xs gap-4"
    >
      <p>&copy; {currentYear} {profile.name}. {ui?.footer?.rights}</p>
      <div class="flex gap-4">
        <p>{ui?.footer?.builtWith}</p>
      </div>
    </div>
  </div>
</footer>
