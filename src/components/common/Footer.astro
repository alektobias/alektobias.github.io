---
import fs from "node:fs/promises";
import path from "node:path";
import { SocialIcon } from "../ui/SocialIcon";
import contact from "../../../docs/data/contact.json";
import { loadUiData } from "../../utils/loadData";

interface Props {
  lang?: string;
}

const { lang = "en" } = Astro.props;
const ui = await loadUiData(lang);

// Load Profile Data
const profilePath = path.join(process.cwd(), `docs/data/${lang}/profile.json`);
const profile = JSON.parse(await fs.readFile(profilePath, "utf-8"));

const currentYear = new Date().getFullYear();
const mainTitle = profile.title[0];

const navLinks = [
  { name: ui?.nav?.home, href: "#" },
  { name: ui?.nav?.about, href: "#about" },
  { name: ui?.nav?.skills, href: "#skills" },
  { name: ui?.nav?.experience, href: "#experiences" },
  { name: ui?.nav?.contact, href: "#contact" },
];
---

<footer
  class="bg-black border-t border-white/10 py-12 relative overflow-hidden"
>
  {/* Background glow similar to other sections but subtle */}
  <div
    class="absolute top-0 left-1/2 -translate-x-1/2 w-[600px] h-[200px] bg-purple-900/10 blur-[80px] rounded-full pointer-events-none"
  >
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
    <div
      class="flex flex-col md:flex-row justify-between items-start md:items-center gap-8"
    >
      {/* Brand Section */}
      <div class="space-y-2">
        <h2 class="text-3xl font-bold tracking-tight">
          <span
            class="text-transparent bg-clip-text bg-linear-to-r from-purple-400 to-indigo-400"
          >
            {profile.name}
          </span>
        </h2>
        <p
          class="text-gray-400 font-medium text-sm tracking-wide"
          style={{
            backgroundImage: "linear-gradient(to bottom right, #ccc 70%, #333)", // purple-500, pink-500, blue-500
            backgroundClip: "text",
            WebkitBackgroundClip: "text",
            color: "transparent",
          }}
        >
          {mainTitle}
        </p>
      </div>

      {/* Navigation & Social */}
      <div class="flex flex-col md:items-end gap-6 w-full md:w-auto">
        <nav class="flex flex-wrap gap-6 text-sm font-medium">
          {
            navLinks.map((link) => (
              <a
                href={link.href}
                class="text-gray-400 hover:text-purple-400 transition-colors"
              >
                {link.name}
              </a>
            ))
          }
        </nav>

        <div class="flex gap-4">
          {/* WhatsApp */}
          <a
            href={`https://wa.me/${contact.phone.replace(/\D/g, "")}`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-400 hover:text-green-400 transition-colors p-2 hover:bg-white/5 rounded-lg"
            aria-label={ui?.contact?.whatsapp}
          >
            <SocialIcon name="whatsapp" className="w-5 h-5" />
          </a>

          {/* Email */}
          <a
            href={`mailto:${contact.email}`}
            class="text-gray-400 hover:text-purple-400 transition-colors p-2 hover:bg-white/5 rounded-lg"
            aria-label={ui?.contact?.email}
          >
            <SocialIcon name="email" className="w-5 h-5" />
          </a>

          {/* LinkedIn */}
          <a
            href={`https://${contact.linkedin}`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-400 hover:text-[#0077b5] transition-colors p-2 hover:bg-white/5 rounded-lg"
            aria-label={ui?.contact?.linkedin}
          >
            <SocialIcon name="linkedin" className="w-5 h-5" />
          </a>

          {/* GitHub */}
          <a
            href={`https://${contact.github}`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-lg"
            aria-label={ui?.contact?.github}
          >
            <SocialIcon name="github" className="w-5 h-5" />
          </a>
        </div>
      </div>
    </div>

    <div
      class="mt-12 pt-8 border-t border-white/5 flex flex-col md:flex-row justify-between items-center text-gray-600 text-xs gap-4"
    >
      <p>&copy; {currentYear} {profile.name}. {ui?.footer?.rights}</p>
      <div class="flex gap-4">
        <p>{ui?.footer?.builtWith}</p>
      </div>
    </div>
  </div>
</footer>
